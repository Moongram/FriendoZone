{"ast":null,"code":"import _slicedToArray from\"/Users/gaoqiantong/Desktop/comp431/hw/final-frontend-Moongram/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import userDataTest from'../users.json';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginForm=function LoginForm(_ref){var navigate=_ref.navigate;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var _useState7=useState(userDataTest),_useState8=_slicedToArray(_useState7,2),users=_useState8[0],setUsers=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isLoggedIn=_useState10[0],setIsLoggedIn=_useState10[1];var validate=function validate(event){if(users.length===0){setUsers(userDataTest);}event.preventDefault();setErrorMessage('');var backendUserData={username:username,password:password};axios.post('https://lily-social-app-7e0ca4e6d236.herokuapp.com/login',backendUserData,{withCredentials:true}).then(function(response){if(response.data.result==='success'){setIsLoggedIn(true);var _username=response.data.username;return axios.get(\"https://lily-social-app-7e0ca4e6d236.herokuapp.com/profile/\".concat(_username),{withCredentials:true});}else{setIsLoggedIn(false);setErrorMessage('Invalid username or password!');return Promise.reject('Login failed');}}).then(function(profileResponse){var userProfile=profileResponse.data;var userData={id:userProfile.username,username:userProfile.username,displayName:userProfile.displayname,email:userProfile.email,phone:userProfile.phone,company:{catchPhrase:userProfile.headline},address:{zipcode:userProfile.zipcode,street:password}};navigate('/main',{state:{userData:userData}});}).catch(function(error){if(error!=='Login failed'){var _error$response,_error$response$data;setErrorMessage(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Error during profile fetch');}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Login Form\"}),/*#__PURE__*/_jsxs(\"form\",{id:\"login\",\"data-testid\":\"login-form-1\",onSubmit:validate,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Username: \",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"account\",\"data-testid\":\"Username\",required:true,onChange:function onChange(e){return setUsername(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Password: \",/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",\"data-testid\":\"Password\",required:true,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"button-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Login\",\"data-testid\":\"login-button\"})})]}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errorMessage}),isLoggedIn&&/*#__PURE__*/_jsx(\"p\",{children:\"Welcome, User!\"})]});};export default LoginForm;","map":{"version":3,"names":["React","useState","useEffect","userDataTest","axios","jsx","_jsx","jsxs","_jsxs","LoginForm","_ref","navigate","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","_useState5","_useState6","errorMessage","setErrorMessage","_useState7","_useState8","users","setUsers","_useState9","_useState10","isLoggedIn","setIsLoggedIn","validate","event","length","preventDefault","backendUserData","post","withCredentials","then","response","data","result","get","concat","Promise","reject","profileResponse","userProfile","userData","id","displayName","displayname","email","phone","company","catchPhrase","headline","address","zipcode","street","state","catch","error","_error$response","_error$response$data","message","className","children","onSubmit","type","name","required","onChange","e","target","value","style","color"],"sources":["/Users/gaoqiantong/Desktop/comp431/hw/final-frontend-Moongram/src/components/LoginForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport userDataTest from '../users.json'\nimport axios from 'axios';\n\nconst LoginForm = ({ navigate }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [users, setUsers] = useState(userDataTest);\n  const [isLoggedIn, setIsLoggedIn] = useState(false); \n\n \n\n  const validate = (event) => {\n    if (users.length === 0) {\n      setUsers(userDataTest)\n    }\n    event.preventDefault();\n    setErrorMessage('');\n\n    const backendUserData = {\n      username: username,\n      password: password\n    }\n    axios.post('https://lily-social-app-7e0ca4e6d236.herokuapp.com/login', backendUserData, { withCredentials: true })\n    .then(response => {\n      if (response.data.result === 'success') {\n        setIsLoggedIn(true);\n        const username = response.data.username; \n        return axios.get(`https://lily-social-app-7e0ca4e6d236.herokuapp.com/profile/${username}`, { withCredentials: true });\n      } else {\n        setIsLoggedIn(false);\n        setErrorMessage('Invalid username or password!');\n        return Promise.reject('Login failed');\n      }\n    })\n    .then(profileResponse => {\n      const userProfile = profileResponse.data;\n      const userData = {\n        id: userProfile.username,\n        username: userProfile.username,\n        displayName: userProfile.displayname,\n        email: userProfile.email,\n        phone: userProfile.phone,\n        company: { catchPhrase: userProfile.headline },\n        address: { zipcode: userProfile.zipcode, street: password }\n      }\n      navigate('/main', { state: { userData: userData } });\n    })\n    .catch(error => {\n      if (error !== 'Login failed') {\n        setErrorMessage(error.response?.data?.message || 'Error during profile fetch');\n      }\n    });\n  };\n\n  return (\n    <div className=\"login-form\" >\n      <h2>User Login Form</h2>\n      <form id=\"login\" data-testid=\"login-form-1\" onSubmit={validate}>\n        <p>Username: <input type=\"text\" name=\"account\" data-testid=\"Username\" required onChange={(e) => setUsername(e.target.value)} /></p>\n        <p>Password: <input type=\"password\" name=\"password\" data-testid=\"Password\" required onChange={(e) => setPassword(e.target.value)} /></p>\n        <div className=\"button-container\">\n          <input type=\"submit\" value=\"Login\" data-testid=\"login-button\"/>\n        </div>\n      </form>\n      {errorMessage && <p style={{ color: 'red' }}>{errorMessage}</p>}\n      {isLoggedIn && <p>Welcome, User!</p>}\n    </div>\n  );\n};\n\nexport default LoginForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}